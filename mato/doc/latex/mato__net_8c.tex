\hypertarget{mato__net_8c}{}\doxysection{mato\+\_\+net.\+c File Reference}
\label{mato__net_8c}\index{mato\_net.c@{mato\_net.c}}
{\ttfamily \#include \char`\"{}mato.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mato\+\_\+net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mato\+\_\+core.\+h\char`\"{}}\newline
Include dependency graph for mato\+\_\+net.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{mato__net_8c__incl}
\end{center}
\end{figure}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{mato__net_8c_a369266c24eacffb87046522897a570d5}{\+\_\+\+G\+N\+U\+\_\+\+S\+O\+U\+R\+CE}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static int \mbox{\hyperlink{mato__net_8c_a54a2b1fd06b74aa7c4538a1c96682697}{config\+\_\+error}} (int ln)
\begin{DoxyCompactList}\small\item\em Print error about reading config at the specified line. \end{DoxyCompactList}\item 
static \mbox{\hyperlink{structnode__info}{node\+\_\+info}} $\ast$ \mbox{\hyperlink{mato__net_8c_ac11580f45a37c70d0eb9789edc078866}{new\+\_\+node\+\_\+info}} (int node\+\_\+id, char $\ast$ip, int port, char $\ast$name, int is\+\_\+online)
\begin{DoxyCompactList}\small\item\em Node\+\_\+info structure constructor, just fills newly allocated copies of data. \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{mato__net_8c_a8cb5e555140d8b4e8afca9670150e482}{read\+\_\+mato\+\_\+config}} ()
\begin{DoxyCompactList}\small\item\em Reads mato networking config file. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato__net_8c_ab4af7bdf1f7414a15270c1162eb25bea}{net\+\_\+mato\+\_\+init}} (int this\+\_\+node\+\_\+identifier)
\item 
void \mbox{\hyperlink{mato__net_8c_aef72140c8f7454f33e028ea9e8e50ce8}{net\+\_\+mato\+\_\+shutdown}} ()
\begin{DoxyCompactList}\small\item\em Close and release resources used by the networking. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_ae19e829cee966e6a6e69ce5dc4b2086b}{node\+\_\+disconnected}} (int s, int node\+\_\+id)
\begin{DoxyCompactList}\small\item\em Clean up all traces of a node (and its modules) after it got disconnected. \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{mato__net_8c_addd190c72656384c5dbbd3e57b2350a8}{net\+\_\+recv\+\_\+int32t}} (int s, int32\+\_\+t $\ast$num, int sending\+\_\+node\+\_\+id)
\begin{DoxyCompactList}\small\item\em Receive one 32-\/bit integer from a socket. \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{mato__net_8c_a63ba58e83b8e160b349c3d191a0040b0}{net\+\_\+recv\+\_\+bytes}} (int s, uint8\+\_\+t $\ast$$\ast$str, int32\+\_\+t $\ast$str\+\_\+len, int sending\+\_\+node\+\_\+id)
\begin{DoxyCompactList}\small\item\em Receive string of bytes from a socket. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_a98ab20a5ce5735e2351054fa072ac6de}{net\+\_\+delete\+\_\+module\+\_\+buffers}} (int node\+\_\+id, int module\+\_\+id)
\begin{DoxyCompactList}\small\item\em Gently delete buffers of the module\+: that is only decrement the reference of the \char`\"{}last valid\char`\"{} packet if we have one. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato__net_8c_affc613d7e6afcf44c6f079084a991b33}{net\+\_\+delete\+\_\+module\+\_\+instance}} (int node\+\_\+id, int module\+\_\+id)
\begin{DoxyCompactList}\small\item\em Soon to be updated... \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_a6ef35d6c4410f72ccce513a286367c92}{net\+\_\+process\+\_\+new\+\_\+module}} (int s, int sending\+\_\+node\+\_\+id)
\begin{DoxyCompactList}\small\item\em Receive and process new module instance message from another node. For the packet format, see net\+\_\+announce\+\_\+new\+\_\+module() function. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_a6add413c66479ff6bb9c9f075edded47}{net\+\_\+process\+\_\+delete\+\_\+module}} (int s, int sending\+\_\+node\+\_\+id)
\begin{DoxyCompactList}\small\item\em Receive and process a delete module message from another node. For the packet format see \mbox{\hyperlink{mato__net_8c_a997bc9295c99204bb12dd33b0d389389}{net\+\_\+send\+\_\+delete\+\_\+module()}} function. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_af3fe49b3a4ba7ce3ee70a013308538be}{net\+\_\+process\+\_\+subscribe\+\_\+module}} (int s, int sending\+\_\+node\+\_\+id)
\begin{DoxyCompactList}\small\item\em Receive and process a subscribe channel message from another node. For the packet format see \mbox{\hyperlink{mato__net_8c_a0479bbf8ad6c495de648fcb75d5ee1ad}{net\+\_\+send\+\_\+subscribe()}} function. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_a9dc5cd600b0a514495a03bf6cd353a88}{net\+\_\+process\+\_\+unsubscribe\+\_\+module}} (int s, int sending\+\_\+node\+\_\+id)
\begin{DoxyCompactList}\small\item\em Receive and process a unsubscribe channel message from another node. For the packet format see \mbox{\hyperlink{mato__net_8c_a0479bbf8ad6c495de648fcb75d5ee1ad}{net\+\_\+send\+\_\+subscribe()}} function. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_a7f943d97a95578ff08592ccd1b7230d6}{net\+\_\+process\+\_\+get\+\_\+data}} (int s, int sending\+\_\+node\+\_\+id)
\begin{DoxyCompactList}\small\item\em Receive and process a get\+\_\+data message from another node. For the packet format see \mbox{\hyperlink{mato__net_8c_ae4829c6e194570023c226f85d8e74486}{net\+\_\+send\+\_\+get\+\_\+data()}} function. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_accd4dbbb93c1ffc4e2c0bc65459df20a}{net\+\_\+process\+\_\+data}} (int s, int sending\+\_\+node\+\_\+id)
\begin{DoxyCompactList}\small\item\em Receive and process a data message that this node have requested by get\+\_\+data message earlier. For the packet format see \mbox{\hyperlink{mato__net_8c_ad33f0d39a802c383a33e794724495b81}{net\+\_\+send\+\_\+data()}} function. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_a44a1f554213d3b183c38eae6294f6755}{net\+\_\+process\+\_\+subscribed\+\_\+data}} (int s, int sending\+\_\+node\+\_\+id)
\begin{DoxyCompactList}\small\item\em Receive and process a subscribed data message from another node. For the packet format see \mbox{\hyperlink{mato__net_8c_a6f5e0a1a54d499b01ed57c8d0ffddeb0}{net\+\_\+send\+\_\+subscribed\+\_\+data()}} function. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_a9a1964cd218d9288ce3746f8506c5b04}{net\+\_\+process\+\_\+global\+\_\+message}} (int s, int sending\+\_\+node\+\_\+id)
\begin{DoxyCompactList}\small\item\em Receive and process a global message from another node. For the packet format see \mbox{\hyperlink{mato__net_8c_ad78484930a66eb4b923b8d94df852f20}{net\+\_\+send\+\_\+global\+\_\+message()}} function. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_a47626d486a29967f77acbebbf03d593e}{process\+\_\+node\+\_\+message}} (int s, int sending\+\_\+node\+\_\+id)
\begin{DoxyCompactList}\small\item\em Receive, unpack, and process a new message arriving from another node from socket s. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_a4cd3ec59bce1b496780de79fac55b73b}{inform\+\_\+about\+\_\+our\+\_\+modules}} (int node\+\_\+id)
\begin{DoxyCompactList}\small\item\em Send information about all our modules to a specific node after it has been connected. \end{DoxyCompactList}\item 
static void $\ast$ \mbox{\hyperlink{mato__net_8c_ab9c6229368418b3bf2b413ae3d5783f1}{reconnecting\+\_\+thread}} (void $\ast$arg)
\begin{DoxyCompactList}\small\item\em This thread monitors connections to all nodes according to config file and tries to connect/reconnect those that are not currently connected. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_aac8e61ea43e2c61d202ad28c646194d3}{fill\+\_\+select\+\_\+fd\+\_\+set}} (fd\+\_\+set $\ast$rfds, int $\ast$nfd)
\begin{DoxyCompactList}\small\item\em Fills the set of \char`\"{}read\char`\"{} file descriptor sets for the \mbox{\hyperlink{mato__net_8c_a4a41ba955d2ae774ef47e9a00442e59b}{communication\+\_\+thread()}} function. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_a86c49d5fb2c98e853e623a1a846cdbdf}{handle\+\_\+incomming\+\_\+connections}} (fd\+\_\+set $\ast$rfds)
\begin{DoxyCompactList}\small\item\em In case the listening socket is selected in rfds, accept the new connection, retrieve the login packet from the other node, store its socket, and mark it online. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_a9240dd1d60fc0a144d43812df1432b82}{handle\+\_\+wakeup\+\_\+signal}} (fd\+\_\+set $\ast$rfds)
\begin{DoxyCompactList}\small\item\em In case a notifications from other threads through wakeup pipe arrives, pick it up. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{mato__net_8c_a7420e33d1907b957903559e7ab3e1d37}{handle\+\_\+messages\+\_\+from\+\_\+other\+\_\+nodes}} (fd\+\_\+set $\ast$rfds)
\begin{DoxyCompactList}\small\item\em For the messages received from other nodes\+: process them. \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{mato__net_8c_a0f6b5932137a12c531a4a8b972b841d9}{wait\+\_\+on\+\_\+select}} (fd\+\_\+set $\ast$rfds, int nfd)
\begin{DoxyCompactList}\small\item\em Call the select() OS system call to wait for any communication arriving. \end{DoxyCompactList}\item 
static void $\ast$ \mbox{\hyperlink{mato__net_8c_a4a41ba955d2ae774ef47e9a00442e59b}{communication\+\_\+thread}} (void $\ast$arg)
\begin{DoxyCompactList}\small\item\em The network receiving thread\+: uses select() to wait for data arriving from all nodes including new nodes connecting. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato__net_8c_a073d05e5bf9e0ffebb49c0251d250c0f}{start\+\_\+networking}} ()
\begin{DoxyCompactList}\small\item\em Create listening socket for other nodes, start reconnecting and communication threads. \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{mato__net_8c_a9ea1de88471a17079784028998ea2318}{net\+\_\+send\+\_\+string}} (int socket, char $\ast$str)
\begin{DoxyCompactList}\small\item\em Send a zero-\/terminated character string to socket. \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{mato__net_8c_aee22705308a288921d023d92f678abb6}{net\+\_\+send\+\_\+bytes}} (int socket, uint8\+\_\+t $\ast$data, int32\+\_\+t length)
\begin{DoxyCompactList}\small\item\em Send an array of bytes to socket. \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{mato__net_8c_a6bea61f44e339ce28149f82c5fbbc533}{net\+\_\+send\+\_\+int32t}} (int socket, int32\+\_\+t num)
\begin{DoxyCompactList}\small\item\em Send 32-\/bit signed integer to a socket. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato__net_8c_ad33f0d39a802c383a33e794724495b81}{net\+\_\+send\+\_\+data}} (int node\+\_\+id, int get\+\_\+data\+\_\+id, uint8\+\_\+t $\ast$data, int32\+\_\+t data\+\_\+length)
\begin{DoxyCompactList}\small\item\em Send data that were requested by M\+S\+G\+\_\+\+G\+E\+T\+\_\+\+D\+A\+TA message to the node that requested. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato__net_8c_a6f5e0a1a54d499b01ed57c8d0ffddeb0}{net\+\_\+send\+\_\+subscribed\+\_\+data}} (int subscribed\+\_\+node\+\_\+id, \mbox{\hyperlink{structchannel__data}{channel\+\_\+data}} $\ast$cd)
\begin{DoxyCompactList}\small\item\em Send a new message posted by our local module to another node that is subscribed to that channel. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato__net_8c_ae5a212558cd3b1a1ec8c3852b5a445c0}{net\+\_\+broadcast\+\_\+new\+\_\+module}} (int module\+\_\+id)
\begin{DoxyCompactList}\small\item\em Broadcast information about new local module instance to all other nodes. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato__net_8c_ad8913452c8999b38b60a3732577d9e64}{net\+\_\+send\+\_\+new\+\_\+module}} (int node\+\_\+id, int module\+\_\+id)
\begin{DoxyCompactList}\small\item\em Send information about new local module instance to a specific node. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato__net_8c_ae4829c6e194570023c226f85d8e74486}{net\+\_\+send\+\_\+get\+\_\+data}} (int node\+\_\+id, int module\+\_\+id, int channel, int get\+\_\+data\+\_\+id)
\begin{DoxyCompactList}\small\item\em Request data from a channel of a module on a different node. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato__net_8c_a997bc9295c99204bb12dd33b0d389389}{net\+\_\+send\+\_\+delete\+\_\+module}} (int module\+\_\+id)
\begin{DoxyCompactList}\small\item\em Broadcast information that module at this node has been deleted. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato__net_8c_a0479bbf8ad6c495de648fcb75d5ee1ad}{net\+\_\+send\+\_\+subscribe}} (int node\+\_\+id, int module\+\_\+id, int channel)
\begin{DoxyCompactList}\small\item\em Send a subscription to a channel of a module running on a different node. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato__net_8c_a21f2927c0c042e1407dd7ef4c9b9d93a}{net\+\_\+send\+\_\+unsubscribe}} (int node\+\_\+id, int module\+\_\+id, int channel)
\begin{DoxyCompactList}\small\item\em Send a unsubscription to a channel of a module running on a different node. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato__net_8c_ad78484930a66eb4b923b8d94df852f20}{net\+\_\+send\+\_\+global\+\_\+message}} (int sending\+\_\+module\+\_\+id, int message\+\_\+id, uint8\+\_\+t $\ast$message\+\_\+data, int message\+\_\+length)
\begin{DoxyCompactList}\small\item\em Broadcast global message to all other nodes. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int32\+\_\+t \mbox{\hyperlink{mato__net_8c_aeed909953e337ee4b9dc137a8263685f}{this\+\_\+node\+\_\+id}}
\begin{DoxyCompactList}\small\item\em Id of this computational node. \end{DoxyCompactList}\item 
G\+Array $\ast$ \mbox{\hyperlink{mato__net_8c_aeda73a8fe41e64b74dd570e4ff50963f}{nodes}}
\begin{DoxyCompactList}\small\item\em Contains node info for all computational nodes filled from config file in mato\+\_\+init. \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{mato__net_8c_ab5839ffc6c4efa53af772074d7723df9}{listening\+\_\+socket}}
\begin{DoxyCompactList}\small\item\em Socket for accepting connections from other nodes. \end{DoxyCompactList}\item 
static G\+Array $\ast$ \mbox{\hyperlink{mato__net_8c_ae7ae885d6a7da0fc88e0f0eaa0c3cd2d}{sockets}}
\begin{DoxyCompactList}\small\item\em Communication sockets with all the other nodes. \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{mato__net_8c_a256097db23e1f2f59cf3afd9605c5deb}{select\+\_\+wakeup\+\_\+pipe}} \mbox{[}2\mbox{]}
\begin{DoxyCompactList}\small\item\em pipe for sending a signal to select() waiting on msgs from nodes -\/ it has to be interrupted when new node connects (or similar events occur) \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementation of the Mato control framework -\/ networking with other nodes. 

\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{mato__net_8c_a369266c24eacffb87046522897a570d5}\label{mato__net_8c_a369266c24eacffb87046522897a570d5}} 
\index{mato\_net.c@{mato\_net.c}!\_GNU\_SOURCE@{\_GNU\_SOURCE}}
\index{\_GNU\_SOURCE@{\_GNU\_SOURCE}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{\_GNU\_SOURCE}{\_GNU\_SOURCE}}
{\footnotesize\ttfamily \#define \+\_\+\+G\+N\+U\+\_\+\+S\+O\+U\+R\+CE}



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{mato__net_8c_a4a41ba955d2ae774ef47e9a00442e59b}\label{mato__net_8c_a4a41ba955d2ae774ef47e9a00442e59b}} 
\index{mato\_net.c@{mato\_net.c}!communication\_thread@{communication\_thread}}
\index{communication\_thread@{communication\_thread}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{communication\_thread()}{communication\_thread()}}
{\footnotesize\ttfamily static void$\ast$ communication\+\_\+thread (\begin{DoxyParamCaption}\item[{void $\ast$}]{arg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



The network receiving thread\+: uses select() to wait for data arriving from all nodes including new nodes connecting. 

Dispatches the arriving messages to the \mbox{\hyperlink{mato__net_8c_a47626d486a29967f77acbebbf03d593e}{process\+\_\+node\+\_\+message()}} function. \mbox{\Hypertarget{mato__net_8c_a54a2b1fd06b74aa7c4538a1c96682697}\label{mato__net_8c_a54a2b1fd06b74aa7c4538a1c96682697}} 
\index{mato\_net.c@{mato\_net.c}!config\_error@{config\_error}}
\index{config\_error@{config\_error}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{config\_error()}{config\_error()}}
{\footnotesize\ttfamily static int config\+\_\+error (\begin{DoxyParamCaption}\item[{int}]{ln }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Print error about reading config at the specified line. 

\mbox{\Hypertarget{mato__net_8c_aac8e61ea43e2c61d202ad28c646194d3}\label{mato__net_8c_aac8e61ea43e2c61d202ad28c646194d3}} 
\index{mato\_net.c@{mato\_net.c}!fill\_select\_fd\_set@{fill\_select\_fd\_set}}
\index{fill\_select\_fd\_set@{fill\_select\_fd\_set}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{fill\_select\_fd\_set()}{fill\_select\_fd\_set()}}
{\footnotesize\ttfamily static void fill\+\_\+select\+\_\+fd\+\_\+set (\begin{DoxyParamCaption}\item[{fd\+\_\+set $\ast$}]{rfds,  }\item[{int $\ast$}]{nfd }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Fills the set of \char`\"{}read\char`\"{} file descriptor sets for the \mbox{\hyperlink{mato__net_8c_a4a41ba955d2ae774ef47e9a00442e59b}{communication\+\_\+thread()}} function. 

Includes the listening\+\_\+socket, read end of the select\+\_\+wakeup\+\_\+pipe, and all open sockets with the other connected nodes. \mbox{\Hypertarget{mato__net_8c_a86c49d5fb2c98e853e623a1a846cdbdf}\label{mato__net_8c_a86c49d5fb2c98e853e623a1a846cdbdf}} 
\index{mato\_net.c@{mato\_net.c}!handle\_incomming\_connections@{handle\_incomming\_connections}}
\index{handle\_incomming\_connections@{handle\_incomming\_connections}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{handle\_incomming\_connections()}{handle\_incomming\_connections()}}
{\footnotesize\ttfamily static void handle\+\_\+incomming\+\_\+connections (\begin{DoxyParamCaption}\item[{fd\+\_\+set $\ast$}]{rfds }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



In case the listening socket is selected in rfds, accept the new connection, retrieve the login packet from the other node, store its socket, and mark it online. 

\mbox{\Hypertarget{mato__net_8c_a7420e33d1907b957903559e7ab3e1d37}\label{mato__net_8c_a7420e33d1907b957903559e7ab3e1d37}} 
\index{mato\_net.c@{mato\_net.c}!handle\_messages\_from\_other\_nodes@{handle\_messages\_from\_other\_nodes}}
\index{handle\_messages\_from\_other\_nodes@{handle\_messages\_from\_other\_nodes}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{handle\_messages\_from\_other\_nodes()}{handle\_messages\_from\_other\_nodes()}}
{\footnotesize\ttfamily static void handle\+\_\+messages\+\_\+from\+\_\+other\+\_\+nodes (\begin{DoxyParamCaption}\item[{fd\+\_\+set $\ast$}]{rfds }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



For the messages received from other nodes\+: process them. 

\mbox{\Hypertarget{mato__net_8c_a9240dd1d60fc0a144d43812df1432b82}\label{mato__net_8c_a9240dd1d60fc0a144d43812df1432b82}} 
\index{mato\_net.c@{mato\_net.c}!handle\_wakeup\_signal@{handle\_wakeup\_signal}}
\index{handle\_wakeup\_signal@{handle\_wakeup\_signal}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{handle\_wakeup\_signal()}{handle\_wakeup\_signal()}}
{\footnotesize\ttfamily static void handle\+\_\+wakeup\+\_\+signal (\begin{DoxyParamCaption}\item[{fd\+\_\+set $\ast$}]{rfds }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



In case a notifications from other threads through wakeup pipe arrives, pick it up. 

\mbox{\Hypertarget{mato__net_8c_a4cd3ec59bce1b496780de79fac55b73b}\label{mato__net_8c_a4cd3ec59bce1b496780de79fac55b73b}} 
\index{mato\_net.c@{mato\_net.c}!inform\_about\_our\_modules@{inform\_about\_our\_modules}}
\index{inform\_about\_our\_modules@{inform\_about\_our\_modules}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{inform\_about\_our\_modules()}{inform\_about\_our\_modules()}}
{\footnotesize\ttfamily static void inform\+\_\+about\+\_\+our\+\_\+modules (\begin{DoxyParamCaption}\item[{int}]{node\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Send information about all our modules to a specific node after it has been connected. 

\mbox{\Hypertarget{mato__net_8c_ae5a212558cd3b1a1ec8c3852b5a445c0}\label{mato__net_8c_ae5a212558cd3b1a1ec8c3852b5a445c0}} 
\index{mato\_net.c@{mato\_net.c}!net\_broadcast\_new\_module@{net\_broadcast\_new\_module}}
\index{net\_broadcast\_new\_module@{net\_broadcast\_new\_module}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_broadcast\_new\_module()}{net\_broadcast\_new\_module()}}
{\footnotesize\ttfamily void net\+\_\+broadcast\+\_\+new\+\_\+module (\begin{DoxyParamCaption}\item[{int}]{module\+\_\+id }\end{DoxyParamCaption})}



Broadcast information about new local module instance to all other nodes. 

\mbox{\Hypertarget{mato__net_8c_a98ab20a5ce5735e2351054fa072ac6de}\label{mato__net_8c_a98ab20a5ce5735e2351054fa072ac6de}} 
\index{mato\_net.c@{mato\_net.c}!net\_delete\_module\_buffers@{net\_delete\_module\_buffers}}
\index{net\_delete\_module\_buffers@{net\_delete\_module\_buffers}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_delete\_module\_buffers()}{net\_delete\_module\_buffers()}}
{\footnotesize\ttfamily static void net\+\_\+delete\+\_\+module\+\_\+buffers (\begin{DoxyParamCaption}\item[{int}]{node\+\_\+id,  }\item[{int}]{module\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Gently delete buffers of the module\+: that is only decrement the reference of the \char`\"{}last valid\char`\"{} packet if we have one. 

But this is not a good idea, it will go away soon. \mbox{\Hypertarget{mato__net_8c_affc613d7e6afcf44c6f079084a991b33}\label{mato__net_8c_affc613d7e6afcf44c6f079084a991b33}} 
\index{mato\_net.c@{mato\_net.c}!net\_delete\_module\_instance@{net\_delete\_module\_instance}}
\index{net\_delete\_module\_instance@{net\_delete\_module\_instance}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_delete\_module\_instance()}{net\_delete\_module\_instance()}}
{\footnotesize\ttfamily void net\+\_\+delete\+\_\+module\+\_\+instance (\begin{DoxyParamCaption}\item[{int}]{node\+\_\+id,  }\item[{int}]{module\+\_\+id }\end{DoxyParamCaption})}



Soon to be updated... 

\mbox{\Hypertarget{mato__net_8c_ab4af7bdf1f7414a15270c1162eb25bea}\label{mato__net_8c_ab4af7bdf1f7414a15270c1162eb25bea}} 
\index{mato\_net.c@{mato\_net.c}!net\_mato\_init@{net\_mato\_init}}
\index{net\_mato\_init@{net\_mato\_init}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_mato\_init()}{net\_mato\_init()}}
{\footnotesize\ttfamily void net\+\_\+mato\+\_\+init (\begin{DoxyParamCaption}\item[{int}]{this\+\_\+node\+\_\+identifier }\end{DoxyParamCaption})}

\mbox{\Hypertarget{mato__net_8c_aef72140c8f7454f33e028ea9e8e50ce8}\label{mato__net_8c_aef72140c8f7454f33e028ea9e8e50ce8}} 
\index{mato\_net.c@{mato\_net.c}!net\_mato\_shutdown@{net\_mato\_shutdown}}
\index{net\_mato\_shutdown@{net\_mato\_shutdown}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_mato\_shutdown()}{net\_mato\_shutdown()}}
{\footnotesize\ttfamily void net\+\_\+mato\+\_\+shutdown (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Close and release resources used by the networking. 

\mbox{\Hypertarget{mato__net_8c_accd4dbbb93c1ffc4e2c0bc65459df20a}\label{mato__net_8c_accd4dbbb93c1ffc4e2c0bc65459df20a}} 
\index{mato\_net.c@{mato\_net.c}!net\_process\_data@{net\_process\_data}}
\index{net\_process\_data@{net\_process\_data}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_process\_data()}{net\_process\_data()}}
{\footnotesize\ttfamily static void net\+\_\+process\+\_\+data (\begin{DoxyParamCaption}\item[{int}]{s,  }\item[{int}]{sending\+\_\+node\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Receive and process a data message that this node have requested by get\+\_\+data message earlier. For the packet format see \mbox{\hyperlink{mato__net_8c_ad33f0d39a802c383a33e794724495b81}{net\+\_\+send\+\_\+data()}} function. 

\mbox{\Hypertarget{mato__net_8c_a6add413c66479ff6bb9c9f075edded47}\label{mato__net_8c_a6add413c66479ff6bb9c9f075edded47}} 
\index{mato\_net.c@{mato\_net.c}!net\_process\_delete\_module@{net\_process\_delete\_module}}
\index{net\_process\_delete\_module@{net\_process\_delete\_module}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_process\_delete\_module()}{net\_process\_delete\_module()}}
{\footnotesize\ttfamily static void net\+\_\+process\+\_\+delete\+\_\+module (\begin{DoxyParamCaption}\item[{int}]{s,  }\item[{int}]{sending\+\_\+node\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Receive and process a delete module message from another node. For the packet format see \mbox{\hyperlink{mato__net_8c_a997bc9295c99204bb12dd33b0d389389}{net\+\_\+send\+\_\+delete\+\_\+module()}} function. 

\mbox{\Hypertarget{mato__net_8c_a7f943d97a95578ff08592ccd1b7230d6}\label{mato__net_8c_a7f943d97a95578ff08592ccd1b7230d6}} 
\index{mato\_net.c@{mato\_net.c}!net\_process\_get\_data@{net\_process\_get\_data}}
\index{net\_process\_get\_data@{net\_process\_get\_data}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_process\_get\_data()}{net\_process\_get\_data()}}
{\footnotesize\ttfamily static void net\+\_\+process\+\_\+get\+\_\+data (\begin{DoxyParamCaption}\item[{int}]{s,  }\item[{int}]{sending\+\_\+node\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Receive and process a get\+\_\+data message from another node. For the packet format see \mbox{\hyperlink{mato__net_8c_ae4829c6e194570023c226f85d8e74486}{net\+\_\+send\+\_\+get\+\_\+data()}} function. 

\mbox{\Hypertarget{mato__net_8c_a9a1964cd218d9288ce3746f8506c5b04}\label{mato__net_8c_a9a1964cd218d9288ce3746f8506c5b04}} 
\index{mato\_net.c@{mato\_net.c}!net\_process\_global\_message@{net\_process\_global\_message}}
\index{net\_process\_global\_message@{net\_process\_global\_message}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_process\_global\_message()}{net\_process\_global\_message()}}
{\footnotesize\ttfamily static void net\+\_\+process\+\_\+global\+\_\+message (\begin{DoxyParamCaption}\item[{int}]{s,  }\item[{int}]{sending\+\_\+node\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Receive and process a global message from another node. For the packet format see \mbox{\hyperlink{mato__net_8c_ad78484930a66eb4b923b8d94df852f20}{net\+\_\+send\+\_\+global\+\_\+message()}} function. 

\mbox{\Hypertarget{mato__net_8c_a6ef35d6c4410f72ccce513a286367c92}\label{mato__net_8c_a6ef35d6c4410f72ccce513a286367c92}} 
\index{mato\_net.c@{mato\_net.c}!net\_process\_new\_module@{net\_process\_new\_module}}
\index{net\_process\_new\_module@{net\_process\_new\_module}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_process\_new\_module()}{net\_process\_new\_module()}}
{\footnotesize\ttfamily static void net\+\_\+process\+\_\+new\+\_\+module (\begin{DoxyParamCaption}\item[{int}]{s,  }\item[{int}]{sending\+\_\+node\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Receive and process new module instance message from another node. For the packet format, see net\+\_\+announce\+\_\+new\+\_\+module() function. 

\mbox{\Hypertarget{mato__net_8c_af3fe49b3a4ba7ce3ee70a013308538be}\label{mato__net_8c_af3fe49b3a4ba7ce3ee70a013308538be}} 
\index{mato\_net.c@{mato\_net.c}!net\_process\_subscribe\_module@{net\_process\_subscribe\_module}}
\index{net\_process\_subscribe\_module@{net\_process\_subscribe\_module}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_process\_subscribe\_module()}{net\_process\_subscribe\_module()}}
{\footnotesize\ttfamily static void net\+\_\+process\+\_\+subscribe\+\_\+module (\begin{DoxyParamCaption}\item[{int}]{s,  }\item[{int}]{sending\+\_\+node\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Receive and process a subscribe channel message from another node. For the packet format see \mbox{\hyperlink{mato__net_8c_a0479bbf8ad6c495de648fcb75d5ee1ad}{net\+\_\+send\+\_\+subscribe()}} function. 

\mbox{\Hypertarget{mato__net_8c_a44a1f554213d3b183c38eae6294f6755}\label{mato__net_8c_a44a1f554213d3b183c38eae6294f6755}} 
\index{mato\_net.c@{mato\_net.c}!net\_process\_subscribed\_data@{net\_process\_subscribed\_data}}
\index{net\_process\_subscribed\_data@{net\_process\_subscribed\_data}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_process\_subscribed\_data()}{net\_process\_subscribed\_data()}}
{\footnotesize\ttfamily static void net\+\_\+process\+\_\+subscribed\+\_\+data (\begin{DoxyParamCaption}\item[{int}]{s,  }\item[{int}]{sending\+\_\+node\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Receive and process a subscribed data message from another node. For the packet format see \mbox{\hyperlink{mato__net_8c_a6f5e0a1a54d499b01ed57c8d0ffddeb0}{net\+\_\+send\+\_\+subscribed\+\_\+data()}} function. 

\mbox{\Hypertarget{mato__net_8c_a9dc5cd600b0a514495a03bf6cd353a88}\label{mato__net_8c_a9dc5cd600b0a514495a03bf6cd353a88}} 
\index{mato\_net.c@{mato\_net.c}!net\_process\_unsubscribe\_module@{net\_process\_unsubscribe\_module}}
\index{net\_process\_unsubscribe\_module@{net\_process\_unsubscribe\_module}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_process\_unsubscribe\_module()}{net\_process\_unsubscribe\_module()}}
{\footnotesize\ttfamily static void net\+\_\+process\+\_\+unsubscribe\+\_\+module (\begin{DoxyParamCaption}\item[{int}]{s,  }\item[{int}]{sending\+\_\+node\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Receive and process a unsubscribe channel message from another node. For the packet format see \mbox{\hyperlink{mato__net_8c_a0479bbf8ad6c495de648fcb75d5ee1ad}{net\+\_\+send\+\_\+subscribe()}} function. 

\mbox{\Hypertarget{mato__net_8c_a63ba58e83b8e160b349c3d191a0040b0}\label{mato__net_8c_a63ba58e83b8e160b349c3d191a0040b0}} 
\index{mato\_net.c@{mato\_net.c}!net\_recv\_bytes@{net\_recv\_bytes}}
\index{net\_recv\_bytes@{net\_recv\_bytes}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_recv\_bytes()}{net\_recv\_bytes()}}
{\footnotesize\ttfamily static int net\+\_\+recv\+\_\+bytes (\begin{DoxyParamCaption}\item[{int}]{s,  }\item[{uint8\+\_\+t $\ast$$\ast$}]{str,  }\item[{int32\+\_\+t $\ast$}]{str\+\_\+len,  }\item[{int}]{sending\+\_\+node\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Receive string of bytes from a socket. 

This could be a zero-\/terminated string, or any other bunch of bytes. String is sent as int32\+\_\+t (length+1) and then data. Returns 0 on failure (and the sending node is updated to be off-\/line), otherwise returns 1. See \mbox{\hyperlink{mato__net_8c_a9ea1de88471a17079784028998ea2318}{net\+\_\+send\+\_\+string()}} function. \mbox{\Hypertarget{mato__net_8c_addd190c72656384c5dbbd3e57b2350a8}\label{mato__net_8c_addd190c72656384c5dbbd3e57b2350a8}} 
\index{mato\_net.c@{mato\_net.c}!net\_recv\_int32t@{net\_recv\_int32t}}
\index{net\_recv\_int32t@{net\_recv\_int32t}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_recv\_int32t()}{net\_recv\_int32t()}}
{\footnotesize\ttfamily static int net\+\_\+recv\+\_\+int32t (\begin{DoxyParamCaption}\item[{int}]{s,  }\item[{int32\+\_\+t $\ast$}]{num,  }\item[{int}]{sending\+\_\+node\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Receive one 32-\/bit integer from a socket. 

Returns 0 on failure (and the sending node is updated to be off-\/line), otherwise returns 1. See net\+\_\+send\+\_\+int32\+\_\+t() function. \mbox{\Hypertarget{mato__net_8c_aee22705308a288921d023d92f678abb6}\label{mato__net_8c_aee22705308a288921d023d92f678abb6}} 
\index{mato\_net.c@{mato\_net.c}!net\_send\_bytes@{net\_send\_bytes}}
\index{net\_send\_bytes@{net\_send\_bytes}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_send\_bytes()}{net\_send\_bytes()}}
{\footnotesize\ttfamily static int net\+\_\+send\+\_\+bytes (\begin{DoxyParamCaption}\item[{int}]{socket,  }\item[{uint8\+\_\+t $\ast$}]{data,  }\item[{int32\+\_\+t}]{length }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Send an array of bytes to socket. 

First send its length as int32\+\_\+t and then data. See \mbox{\hyperlink{mato__net_8c_a9ea1de88471a17079784028998ea2318}{net\+\_\+send\+\_\+string()}} and \mbox{\hyperlink{mato__net_8c_a63ba58e83b8e160b349c3d191a0040b0}{net\+\_\+recv\+\_\+bytes()}} functions. \mbox{\Hypertarget{mato__net_8c_ad33f0d39a802c383a33e794724495b81}\label{mato__net_8c_ad33f0d39a802c383a33e794724495b81}} 
\index{mato\_net.c@{mato\_net.c}!net\_send\_data@{net\_send\_data}}
\index{net\_send\_data@{net\_send\_data}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_send\_data()}{net\_send\_data()}}
{\footnotesize\ttfamily void net\+\_\+send\+\_\+data (\begin{DoxyParamCaption}\item[{int}]{node\+\_\+id,  }\item[{int}]{get\+\_\+data\+\_\+id,  }\item[{uint8\+\_\+t $\ast$}]{data,  }\item[{int32\+\_\+t}]{data\+\_\+length }\end{DoxyParamCaption})}



Send data that were requested by M\+S\+G\+\_\+\+G\+E\+T\+\_\+\+D\+A\+TA message to the node that requested. 


\begin{DoxyCode}{0}
\DoxyCodeLine{Packet format:}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\mbox{\hyperlink{mato__net_8h_ac319d4cc777b829878d4012f076ad5fa}{MSG\_DATA}}                  int32}
\DoxyCodeLine{sending\_node\_id           int32}
\DoxyCodeLine{get\_data\_id               int32}
\DoxyCodeLine{len(data)                 int32}
\DoxyCodeLine{data                      variable}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\end{DoxyCode}
 \mbox{\Hypertarget{mato__net_8c_a997bc9295c99204bb12dd33b0d389389}\label{mato__net_8c_a997bc9295c99204bb12dd33b0d389389}} 
\index{mato\_net.c@{mato\_net.c}!net\_send\_delete\_module@{net\_send\_delete\_module}}
\index{net\_send\_delete\_module@{net\_send\_delete\_module}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_send\_delete\_module()}{net\_send\_delete\_module()}}
{\footnotesize\ttfamily void net\+\_\+send\+\_\+delete\+\_\+module (\begin{DoxyParamCaption}\item[{int}]{module\+\_\+id }\end{DoxyParamCaption})}



Broadcast information that module at this node has been deleted. 


\begin{DoxyCode}{0}
\DoxyCodeLine{Packet format:}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\mbox{\hyperlink{mato__net_8h_a177f9c05035981b72ff09e2310b1388d}{MSG\_DELETED\_MODULE\_INSTANCE}}  int32}
\DoxyCodeLine{sending\_node\_id              int32}
\DoxyCodeLine{module\_id                    int32}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\end{DoxyCode}
 \mbox{\Hypertarget{mato__net_8c_ae4829c6e194570023c226f85d8e74486}\label{mato__net_8c_ae4829c6e194570023c226f85d8e74486}} 
\index{mato\_net.c@{mato\_net.c}!net\_send\_get\_data@{net\_send\_get\_data}}
\index{net\_send\_get\_data@{net\_send\_get\_data}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_send\_get\_data()}{net\_send\_get\_data()}}
{\footnotesize\ttfamily void net\+\_\+send\+\_\+get\+\_\+data (\begin{DoxyParamCaption}\item[{int}]{node\+\_\+id,  }\item[{int}]{module\+\_\+id,  }\item[{int}]{channel,  }\item[{int}]{get\+\_\+data\+\_\+id }\end{DoxyParamCaption})}



Request data from a channel of a module on a different node. 


\begin{DoxyCode}{0}
\DoxyCodeLine{Packet format:}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\mbox{\hyperlink{mato__net_8h_a57594e74f6296fcda847e25fc7810603}{MSG\_GET\_DATA}}              int32}
\DoxyCodeLine{sending\_node\_id           int32}
\DoxyCodeLine{module\_id                 int32}
\DoxyCodeLine{channel                   int32}
\DoxyCodeLine{get\_data\_id               int32}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\end{DoxyCode}
 \mbox{\Hypertarget{mato__net_8c_ad78484930a66eb4b923b8d94df852f20}\label{mato__net_8c_ad78484930a66eb4b923b8d94df852f20}} 
\index{mato\_net.c@{mato\_net.c}!net\_send\_global\_message@{net\_send\_global\_message}}
\index{net\_send\_global\_message@{net\_send\_global\_message}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_send\_global\_message()}{net\_send\_global\_message()}}
{\footnotesize\ttfamily void net\+\_\+send\+\_\+global\+\_\+message (\begin{DoxyParamCaption}\item[{int}]{sending\+\_\+module\+\_\+id,  }\item[{int}]{message\+\_\+id,  }\item[{uint8\+\_\+t $\ast$}]{message\+\_\+data,  }\item[{int}]{message\+\_\+length }\end{DoxyParamCaption})}



Broadcast global message to all other nodes. 


\begin{DoxyCode}{0}
\DoxyCodeLine{Packet format:}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\mbox{\hyperlink{mato__net_8h_aacd704c39679de7ea563044ffed64794}{MSG\_GLOBAL\_MESSAGE}}        int32}
\DoxyCodeLine{sending\_node\_id           int32}
\DoxyCodeLine{sending\_module\_id         int32}
\DoxyCodeLine{message\_id                int32}
\DoxyCodeLine{len(message\_data)         int32}
\DoxyCodeLine{message\_data              variable}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\end{DoxyCode}
 \mbox{\Hypertarget{mato__net_8c_a6bea61f44e339ce28149f82c5fbbc533}\label{mato__net_8c_a6bea61f44e339ce28149f82c5fbbc533}} 
\index{mato\_net.c@{mato\_net.c}!net\_send\_int32t@{net\_send\_int32t}}
\index{net\_send\_int32t@{net\_send\_int32t}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_send\_int32t()}{net\_send\_int32t()}}
{\footnotesize\ttfamily static int net\+\_\+send\+\_\+int32t (\begin{DoxyParamCaption}\item[{int}]{socket,  }\item[{int32\+\_\+t}]{num }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Send 32-\/bit signed integer to a socket. 

See net\+\_\+recv\+\_\+int32\+\_\+t() function. \mbox{\Hypertarget{mato__net_8c_ad8913452c8999b38b60a3732577d9e64}\label{mato__net_8c_ad8913452c8999b38b60a3732577d9e64}} 
\index{mato\_net.c@{mato\_net.c}!net\_send\_new\_module@{net\_send\_new\_module}}
\index{net\_send\_new\_module@{net\_send\_new\_module}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_send\_new\_module()}{net\_send\_new\_module()}}
{\footnotesize\ttfamily void net\+\_\+send\+\_\+new\+\_\+module (\begin{DoxyParamCaption}\item[{int}]{node\+\_\+id,  }\item[{int}]{module\+\_\+id }\end{DoxyParamCaption})}



Send information about new local module instance to a specific node. 


\begin{DoxyCode}{0}
\DoxyCodeLine{Packet format:}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\mbox{\hyperlink{mato__net_8h_a0e3a7df94130de2dacc9b60df772627c}{MSG\_NEW\_MODULE\_INSTANCE}}   int32}
\DoxyCodeLine{sending\_node\_id           int32}
\DoxyCodeLine{[local]module\_id          int32}
\DoxyCodeLine{len(module\_name)+1        int32}
\DoxyCodeLine{module\_name               variable}
\DoxyCodeLine{len(module\_type)+1        int32}
\DoxyCodeLine{module\_type               variable}
\DoxyCodeLine{number\_of\_channels        int32}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\end{DoxyCode}
 \mbox{\Hypertarget{mato__net_8c_a9ea1de88471a17079784028998ea2318}\label{mato__net_8c_a9ea1de88471a17079784028998ea2318}} 
\index{mato\_net.c@{mato\_net.c}!net\_send\_string@{net\_send\_string}}
\index{net\_send\_string@{net\_send\_string}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_send\_string()}{net\_send\_string()}}
{\footnotesize\ttfamily static int net\+\_\+send\+\_\+string (\begin{DoxyParamCaption}\item[{int}]{socket,  }\item[{char $\ast$}]{str }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Send a zero-\/terminated character string to socket. 

First send its length+1 as int32\+\_\+t and then data. See \mbox{\hyperlink{mato__net_8c_aee22705308a288921d023d92f678abb6}{net\+\_\+send\+\_\+bytes()}} and \mbox{\hyperlink{mato__net_8c_a63ba58e83b8e160b349c3d191a0040b0}{net\+\_\+recv\+\_\+bytes()}} functions. \mbox{\Hypertarget{mato__net_8c_a0479bbf8ad6c495de648fcb75d5ee1ad}\label{mato__net_8c_a0479bbf8ad6c495de648fcb75d5ee1ad}} 
\index{mato\_net.c@{mato\_net.c}!net\_send\_subscribe@{net\_send\_subscribe}}
\index{net\_send\_subscribe@{net\_send\_subscribe}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_send\_subscribe()}{net\_send\_subscribe()}}
{\footnotesize\ttfamily void net\+\_\+send\+\_\+subscribe (\begin{DoxyParamCaption}\item[{int}]{node\+\_\+id,  }\item[{int}]{module\+\_\+id,  }\item[{int}]{channel }\end{DoxyParamCaption})}



Send a subscription to a channel of a module running on a different node. 


\begin{DoxyCode}{0}
\DoxyCodeLine{Packet format:}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\mbox{\hyperlink{mato__net_8h_af2027af6d3e42f33980d6db493fbb3a4}{MSG\_SUBSCRIBE}}             int32}
\DoxyCodeLine{sending\_node\_id           int32}
\DoxyCodeLine{module\_id                 int32}
\DoxyCodeLine{channel                   int32}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\end{DoxyCode}
 \mbox{\Hypertarget{mato__net_8c_a6f5e0a1a54d499b01ed57c8d0ffddeb0}\label{mato__net_8c_a6f5e0a1a54d499b01ed57c8d0ffddeb0}} 
\index{mato\_net.c@{mato\_net.c}!net\_send\_subscribed\_data@{net\_send\_subscribed\_data}}
\index{net\_send\_subscribed\_data@{net\_send\_subscribed\_data}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_send\_subscribed\_data()}{net\_send\_subscribed\_data()}}
{\footnotesize\ttfamily void net\+\_\+send\+\_\+subscribed\+\_\+data (\begin{DoxyParamCaption}\item[{int}]{subscribed\+\_\+node\+\_\+id,  }\item[{\mbox{\hyperlink{structchannel__data}{channel\+\_\+data}} $\ast$}]{cd }\end{DoxyParamCaption})}



Send a new message posted by our local module to another node that is subscribed to that channel. 


\begin{DoxyCode}{0}
\DoxyCodeLine{Packet format:}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\mbox{\hyperlink{mato__net_8h_ac0f7dba19b63a99a5a7391ba234ccc7f}{MSG\_SUBSCRIBED\_DATA}}       int32}
\DoxyCodeLine{sending\_node\_id           int32}
\DoxyCodeLine{module\_id                 int32}
\DoxyCodeLine{channel                   int32}
\DoxyCodeLine{length                    int32}
\DoxyCodeLine{data                      variable}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\end{DoxyCode}
 \mbox{\Hypertarget{mato__net_8c_a21f2927c0c042e1407dd7ef4c9b9d93a}\label{mato__net_8c_a21f2927c0c042e1407dd7ef4c9b9d93a}} 
\index{mato\_net.c@{mato\_net.c}!net\_send\_unsubscribe@{net\_send\_unsubscribe}}
\index{net\_send\_unsubscribe@{net\_send\_unsubscribe}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{net\_send\_unsubscribe()}{net\_send\_unsubscribe()}}
{\footnotesize\ttfamily void net\+\_\+send\+\_\+unsubscribe (\begin{DoxyParamCaption}\item[{int}]{node\+\_\+id,  }\item[{int}]{module\+\_\+id,  }\item[{int}]{channel }\end{DoxyParamCaption})}



Send a unsubscription to a channel of a module running on a different node. 


\begin{DoxyCode}{0}
\DoxyCodeLine{Packet format:}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\mbox{\hyperlink{mato__net_8h_af2027af6d3e42f33980d6db493fbb3a4}{MSG\_SUBSCRIBE}}             int32}
\DoxyCodeLine{sending\_node\_id           int32}
\DoxyCodeLine{module\_id                 int32}
\DoxyCodeLine{channel                   int32}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\end{DoxyCode}
 \mbox{\Hypertarget{mato__net_8c_ac11580f45a37c70d0eb9789edc078866}\label{mato__net_8c_ac11580f45a37c70d0eb9789edc078866}} 
\index{mato\_net.c@{mato\_net.c}!new\_node\_info@{new\_node\_info}}
\index{new\_node\_info@{new\_node\_info}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{new\_node\_info()}{new\_node\_info()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{structnode__info}{node\+\_\+info}}$\ast$ new\+\_\+node\+\_\+info (\begin{DoxyParamCaption}\item[{int}]{node\+\_\+id,  }\item[{char $\ast$}]{ip,  }\item[{int}]{port,  }\item[{char $\ast$}]{name,  }\item[{int}]{is\+\_\+online }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Node\+\_\+info structure constructor, just fills newly allocated copies of data. 

\mbox{\Hypertarget{mato__net_8c_ae19e829cee966e6a6e69ce5dc4b2086b}\label{mato__net_8c_ae19e829cee966e6a6e69ce5dc4b2086b}} 
\index{mato\_net.c@{mato\_net.c}!node\_disconnected@{node\_disconnected}}
\index{node\_disconnected@{node\_disconnected}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{node\_disconnected()}{node\_disconnected()}}
{\footnotesize\ttfamily static void node\+\_\+disconnected (\begin{DoxyParamCaption}\item[{int}]{s,  }\item[{int}]{node\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Clean up all traces of a node (and its modules) after it got disconnected. 

\mbox{\Hypertarget{mato__net_8c_a47626d486a29967f77acbebbf03d593e}\label{mato__net_8c_a47626d486a29967f77acbebbf03d593e}} 
\index{mato\_net.c@{mato\_net.c}!process\_node\_message@{process\_node\_message}}
\index{process\_node\_message@{process\_node\_message}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{process\_node\_message()}{process\_node\_message()}}
{\footnotesize\ttfamily static void process\+\_\+node\+\_\+message (\begin{DoxyParamCaption}\item[{int}]{s,  }\item[{int}]{sending\+\_\+node\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Receive, unpack, and process a new message arriving from another node from socket s. 

\mbox{\Hypertarget{mato__net_8c_a8cb5e555140d8b4e8afca9670150e482}\label{mato__net_8c_a8cb5e555140d8b4e8afca9670150e482}} 
\index{mato\_net.c@{mato\_net.c}!read\_mato\_config@{read\_mato\_config}}
\index{read\_mato\_config@{read\_mato\_config}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{read\_mato\_config()}{read\_mato\_config()}}
{\footnotesize\ttfamily static int read\+\_\+mato\+\_\+config (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Reads mato networking config file. 

\mbox{\Hypertarget{mato__net_8c_ab9c6229368418b3bf2b413ae3d5783f1}\label{mato__net_8c_ab9c6229368418b3bf2b413ae3d5783f1}} 
\index{mato\_net.c@{mato\_net.c}!reconnecting\_thread@{reconnecting\_thread}}
\index{reconnecting\_thread@{reconnecting\_thread}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{reconnecting\_thread()}{reconnecting\_thread()}}
{\footnotesize\ttfamily static void$\ast$ reconnecting\+\_\+thread (\begin{DoxyParamCaption}\item[{void $\ast$}]{arg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



This thread monitors connections to all nodes according to config file and tries to connect/reconnect those that are not currently connected. 

It runs in the background from the start till the framework shutdown. \mbox{\Hypertarget{mato__net_8c_a073d05e5bf9e0ffebb49c0251d250c0f}\label{mato__net_8c_a073d05e5bf9e0ffebb49c0251d250c0f}} 
\index{mato\_net.c@{mato\_net.c}!start\_networking@{start\_networking}}
\index{start\_networking@{start\_networking}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{start\_networking()}{start\_networking()}}
{\footnotesize\ttfamily void start\+\_\+networking (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Create listening socket for other nodes, start reconnecting and communication threads. 

\mbox{\Hypertarget{mato__net_8c_a0f6b5932137a12c531a4a8b972b841d9}\label{mato__net_8c_a0f6b5932137a12c531a4a8b972b841d9}} 
\index{mato\_net.c@{mato\_net.c}!wait\_on\_select@{wait\_on\_select}}
\index{wait\_on\_select@{wait\_on\_select}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{wait\_on\_select()}{wait\_on\_select()}}
{\footnotesize\ttfamily static int wait\+\_\+on\+\_\+select (\begin{DoxyParamCaption}\item[{fd\+\_\+set $\ast$}]{rfds,  }\item[{int}]{nfd }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Call the select() OS system call to wait for any communication arriving. 



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{mato__net_8c_ab5839ffc6c4efa53af772074d7723df9}\label{mato__net_8c_ab5839ffc6c4efa53af772074d7723df9}} 
\index{mato\_net.c@{mato\_net.c}!listening\_socket@{listening\_socket}}
\index{listening\_socket@{listening\_socket}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{listening\_socket}{listening\_socket}}
{\footnotesize\ttfamily int listening\+\_\+socket\hspace{0.3cm}{\ttfamily [static]}}



Socket for accepting connections from other nodes. 

\mbox{\Hypertarget{mato__net_8c_aeda73a8fe41e64b74dd570e4ff50963f}\label{mato__net_8c_aeda73a8fe41e64b74dd570e4ff50963f}} 
\index{mato\_net.c@{mato\_net.c}!nodes@{nodes}}
\index{nodes@{nodes}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{nodes}{nodes}}
{\footnotesize\ttfamily G\+Array$\ast$ nodes}



Contains node info for all computational nodes filled from config file in mato\+\_\+init. 

\mbox{\Hypertarget{mato__net_8c_a256097db23e1f2f59cf3afd9605c5deb}\label{mato__net_8c_a256097db23e1f2f59cf3afd9605c5deb}} 
\index{mato\_net.c@{mato\_net.c}!select\_wakeup\_pipe@{select\_wakeup\_pipe}}
\index{select\_wakeup\_pipe@{select\_wakeup\_pipe}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{select\_wakeup\_pipe}{select\_wakeup\_pipe}}
{\footnotesize\ttfamily int select\+\_\+wakeup\+\_\+pipe\mbox{[}2\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}



pipe for sending a signal to select() waiting on msgs from nodes -\/ it has to be interrupted when new node connects (or similar events occur) 

\mbox{\Hypertarget{mato__net_8c_ae7ae885d6a7da0fc88e0f0eaa0c3cd2d}\label{mato__net_8c_ae7ae885d6a7da0fc88e0f0eaa0c3cd2d}} 
\index{mato\_net.c@{mato\_net.c}!sockets@{sockets}}
\index{sockets@{sockets}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{sockets}{sockets}}
{\footnotesize\ttfamily G\+Array$\ast$ sockets\hspace{0.3cm}{\ttfamily [static]}}



Communication sockets with all the other nodes. 

\mbox{\Hypertarget{mato__net_8c_aeed909953e337ee4b9dc137a8263685f}\label{mato__net_8c_aeed909953e337ee4b9dc137a8263685f}} 
\index{mato\_net.c@{mato\_net.c}!this\_node\_id@{this\_node\_id}}
\index{this\_node\_id@{this\_node\_id}!mato\_net.c@{mato\_net.c}}
\doxysubsubsection{\texorpdfstring{this\_node\_id}{this\_node\_id}}
{\footnotesize\ttfamily int32\+\_\+t this\+\_\+node\+\_\+id}



Id of this computational node. 

