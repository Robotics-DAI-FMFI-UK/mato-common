\hypertarget{mato_8h}{}\doxysection{mato.\+h File Reference}
\label{mato_8h}\index{mato.h@{mato.h}}
{\ttfamily \#include $<$glib.\+h$>$}\newline
Include dependency graph for mato.\+h\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=131pt]{mato_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{mato_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structmodule__specification}{module\+\_\+specification}}
\begin{DoxyCompactList}\small\item\em Each module type has to provide the callbacks for its module instances. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structmodule__info}{module\+\_\+info}}
\begin{DoxyCompactList}\small\item\em List of modules descriptions consists of structures describing the basic information about a module. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structnode__info}{node\+\_\+info}}
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{mato_8h_a15a2c242b513b39cb717bf70978ce3fa}\label{mato_8h_a15a2c242b513b39cb717bf70978ce3fa}} 
typedef enum subscription\+\_\+type\+\_\+enum {\bfseries subscription\+\_\+type}
\item 
typedef void $\ast$($\ast$ \mbox{\hyperlink{mato_8h_ad20873465b8c85f182244c5a553f2837}{create\+\_\+instance\+\_\+callback}}) (int module\+\_\+id)
\begin{DoxyCompactList}\small\item\em Create instance data of a module and initialize it. \end{DoxyCompactList}\item 
typedef void($\ast$ \mbox{\hyperlink{mato_8h_a5cdf8c706be95dbe5dc32dda2d0aacdf}{start\+\_\+instance\+\_\+callback}}) (void $\ast$\mbox{\hyperlink{mato__core_8h_a0e0d7e8d878428833528a1123d6558c5}{instance\+\_\+data}})
\begin{DoxyCompactList}\small\item\em Start the module instance. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_a19ec8ae2c73a767ac23bcc3c861e8b53}\label{mato_8h_a19ec8ae2c73a767ac23bcc3c861e8b53}} 
typedef void($\ast$ \mbox{\hyperlink{mato_8h_a19ec8ae2c73a767ac23bcc3c861e8b53}{delete\+\_\+instance\+\_\+callback}}) (void $\ast$\mbox{\hyperlink{mato__core_8h_a0e0d7e8d878428833528a1123d6558c5}{instance\+\_\+data}})
\begin{DoxyCompactList}\small\item\em A request to delete the module instance has been made. This callback should deallocate the instance data. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_a984f52f0434bb9e42814bf9c74f4791d}\label{mato_8h_a984f52f0434bb9e42814bf9c74f4791d}} 
typedef void($\ast$ \mbox{\hyperlink{mato_8h_a984f52f0434bb9e42814bf9c74f4791d}{global\+\_\+message\+\_\+callback}}) (void $\ast$\mbox{\hyperlink{mato__core_8h_a0e0d7e8d878428833528a1123d6558c5}{instance\+\_\+data}}, int module\+\_\+id\+\_\+sender, int message\+\_\+id, int msg\+\_\+length, void $\ast$message\+\_\+data)
\begin{DoxyCompactList}\small\item\em When some other module or the main program has sent a global message, this callback of each module is called immediatelly -\/ from the thread of the sender. \end{DoxyCompactList}\item 
typedef void($\ast$ \mbox{\hyperlink{mato_8h_a9345221b935d9505595c583b54d31e86}{subscriber\+\_\+callback}}) (void $\ast$\mbox{\hyperlink{mato__core_8h_a0e0d7e8d878428833528a1123d6558c5}{instance\+\_\+data}}, int sender\+\_\+module\+\_\+id, int data\+\_\+length, void $\ast$new\+\_\+data\+\_\+ptr)
\begin{DoxyCompactList}\small\item\em Modules that subscribe to the data on channels of other module instances provide this callback. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{mato_8h_a97f25ffc5cfdea7210d6d23eec033087}\label{mato_8h_a97f25ffc5cfdea7210d6d23eec033087}} 
enum {\bfseries subscription\+\_\+type\+\_\+enum} \{ {\bfseries direct\+\_\+data\+\_\+ptr} = 1, 
{\bfseries data\+\_\+copy} = 2, 
{\bfseries borrowed\+\_\+pointer} = 3
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{mato_8h_a31f3887a8e72dc1323b6bfbcfbf9d038}\label{mato_8h_a31f3887a8e72dc1323b6bfbcfbf9d038}} 
void \mbox{\hyperlink{mato_8h_a31f3887a8e72dc1323b6bfbcfbf9d038}{mato\+\_\+init}} (int this\+\_\+node\+\_\+identifier)
\begin{DoxyCompactList}\small\item\em Initializes the framework. It must be the first function of the framework to be called. It should be called only once. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato_8h_a43f0570e3ab59d7a021e93113437dcaf}{mato\+\_\+register\+\_\+new\+\_\+type\+\_\+of\+\_\+module}} (char $\ast$type, \mbox{\hyperlink{structmodule__specification}{module\+\_\+specification}} $\ast$specification)
\begin{DoxyCompactList}\small\item\em Register a new module type. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{mato_8h_a411a20bcfa908edbebe617fe5cc54667}{mato\+\_\+create\+\_\+new\+\_\+module\+\_\+instance}} (const char $\ast$module\+\_\+type, const char $\ast$module\+\_\+name)
\begin{DoxyCompactList}\small\item\em The main program (or other module) can call this function to request creation of a module instance. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_a02ef7e731c9c9eaa342352a7e802c183}\label{mato_8h_a02ef7e731c9c9eaa342352a7e802c183}} 
void \mbox{\hyperlink{mato_8h_a02ef7e731c9c9eaa342352a7e802c183}{mato\+\_\+start}} ()
\begin{DoxyCompactList}\small\item\em Start the framework and all modules. This is typically called after all module instances have been created. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato_8h_a62a0865fa5114c0a254435a1369531cf}{mato\+\_\+start\+\_\+module}} (int module\+\_\+id)
\begin{DoxyCompactList}\small\item\em Start a newly created instance of a particular module. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_a6e94d7d4dc09ad58485227e60df20035}\label{mato_8h_a6e94d7d4dc09ad58485227e60df20035}} 
void \mbox{\hyperlink{mato_8h_a6e94d7d4dc09ad58485227e60df20035}{mato\+\_\+delete\+\_\+module\+\_\+instance}} (int module\+\_\+id)
\begin{DoxyCompactList}\small\item\em Allows to dynamically delete a module instance that was previously created. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_aa753d75335e7a6ae0e00a6dcdbdb1412}\label{mato_8h_aa753d75335e7a6ae0e00a6dcdbdb1412}} 
int \mbox{\hyperlink{mato_8h_aa753d75335e7a6ae0e00a6dcdbdb1412}{mato\+\_\+get\+\_\+module\+\_\+id}} (const char $\ast$module\+\_\+name)
\begin{DoxyCompactList}\small\item\em Translate a module name of some existing module instance to its module id. Returns -\/1, if module name is not known. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_a2e839c2dcf0c134166ceca799e7987fd}\label{mato_8h_a2e839c2dcf0c134166ceca799e7987fd}} 
char $\ast$ \mbox{\hyperlink{mato_8h_a2e839c2dcf0c134166ceca799e7987fd}{mato\+\_\+get\+\_\+module\+\_\+name}} (int module\+\_\+id)
\begin{DoxyCompactList}\small\item\em Determine the name of a module with the specified module\+\_\+id. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_a28a6ba77196f8504bab5f3da059c5d5b}\label{mato_8h_a28a6ba77196f8504bab5f3da059c5d5b}} 
char $\ast$ \mbox{\hyperlink{mato_8h_a28a6ba77196f8504bab5f3da059c5d5b}{mato\+\_\+get\+\_\+module\+\_\+type}} (int module\+\_\+id)
\begin{DoxyCompactList}\small\item\em Determine the type of a module with the specified module\+\_\+id. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_af07c3febed32408feb8a11c4d66c2251}\label{mato_8h_af07c3febed32408feb8a11c4d66c2251}} 
int \mbox{\hyperlink{mato_8h_af07c3febed32408feb8a11c4d66c2251}{mato\+\_\+subscribe}} (int subscriber\+\_\+module\+\_\+id, int subscribed\+\_\+module\+\_\+id, int channel, \mbox{\hyperlink{mato_8h_a9345221b935d9505595c583b54d31e86}{subscriber\+\_\+callback}} callback, int subscription\+\_\+type)
\begin{DoxyCompactList}\small\item\em Subscribe on a channel of some module instance. Returns a number that represents this subscription (a subscription\+\_\+id). \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_a14f9462b777a24c86af37b64d84142d0}\label{mato_8h_a14f9462b777a24c86af37b64d84142d0}} 
void \mbox{\hyperlink{mato_8h_a14f9462b777a24c86af37b64d84142d0}{mato\+\_\+unsubscribe}} (int module\+\_\+id, int channel, int subscription\+\_\+id)
\begin{DoxyCompactList}\small\item\em Given a subscription\+\_\+id, cancel the ongoing subscription to a channel of some module instance. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_a7c5249cc4fbb65587357c130ab618427}\label{mato_8h_a7c5249cc4fbb65587357c130ab618427}} 
void $\ast$ \mbox{\hyperlink{mato_8h_a7c5249cc4fbb65587357c130ab618427}{mato\+\_\+get\+\_\+data\+\_\+buffer}} (int size)
\begin{DoxyCompactList}\small\item\em Allocate a memory for a new message to be posted with post\+\_\+data. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_aebd06bdcd1d952465c8c222c663d76fb}\label{mato_8h_aebd06bdcd1d952465c8c222c663d76fb}} 
void \mbox{\hyperlink{mato_8h_aebd06bdcd1d952465c8c222c663d76fb}{mato\+\_\+post\+\_\+data}} (int id\+\_\+of\+\_\+posting\+\_\+module, int channel, int data\+\_\+length, void $\ast$data)
\begin{DoxyCompactList}\small\item\em A module instance posts a new message to its own output data channel by calling this function. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_ae76f55dbca38f9a69095cda5f089a80b}\label{mato_8h_ae76f55dbca38f9a69095cda5f089a80b}} 
int \mbox{\hyperlink{mato_8h_ae76f55dbca38f9a69095cda5f089a80b}{mato\+\_\+send\+\_\+global\+\_\+message}} (int module\+\_\+id\+\_\+sender, int message\+\_\+id, int msg\+\_\+length, void $\ast$message\+\_\+data)
\begin{DoxyCompactList}\small\item\em The main program or any module instance can post a global message to be posted to all modules immediatelly in the same thread by calling this function. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato_8h_af356c7284b6f1d6be285de40d9e23b77}{mato\+\_\+get\+\_\+data}} (int id\+\_\+module, int channel, int $\ast$data\+\_\+length, void $\ast$$\ast$data)
\begin{DoxyCompactList}\small\item\em Retrieve the most recently posted data of some channel of some module instance. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato_8h_af3c84af45ac99910057189ede367d72d}{mato\+\_\+borrow\+\_\+data}} (int id\+\_\+module, int channel, int $\ast$data\+\_\+length, void $\ast$$\ast$data)
\begin{DoxyCompactList}\small\item\em Retrieve the most recently posted data of some channel of some module instance. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato_8h_aedcb803fd4a991e805e6c3813c829a35}{mato\+\_\+release\+\_\+data}} (int id\+\_\+module, int channel, void $\ast$data)
\begin{DoxyCompactList}\small\item\em Return a borrowed pointer that was obtained either by \mbox{\hyperlink{mato_8h_af3c84af45ac99910057189ede367d72d}{mato\+\_\+borrow\+\_\+data()}} or by a callback in the borrowed\+\_\+pointer mode. \end{DoxyCompactList}\item 
G\+Array $\ast$ \mbox{\hyperlink{mato_8h_a5c6a3a9b7e7969e9d9324b1d937ff2a5}{mato\+\_\+get\+\_\+list\+\_\+of\+\_\+all\+\_\+modules}} ()
\begin{DoxyCompactList}\small\item\em Retrieve the list of currently running modules. \end{DoxyCompactList}\item 
G\+Array $\ast$ \mbox{\hyperlink{mato_8h_ac8c86d7dbb7acd09f1884c2e80ec698c}{mato\+\_\+get\+\_\+list\+\_\+of\+\_\+modules}} (char $\ast$type)
\begin{DoxyCompactList}\small\item\em Retrieve the list of currently running modules of the specified type. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_a89c5f00aa3a55188b8a2364314a0b644}\label{mato_8h_a89c5f00aa3a55188b8a2364314a0b644}} 
int \mbox{\hyperlink{mato_8h_a89c5f00aa3a55188b8a2364314a0b644}{mato\+\_\+get\+\_\+number\+\_\+of\+\_\+modules}} ()
\begin{DoxyCompactList}\small\item\em Retrieve the number of currently running modules. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_aeafc9d85e29a73b9b5423cd661bd54c2}\label{mato_8h_aeafc9d85e29a73b9b5423cd661bd54c2}} 
void \mbox{\hyperlink{mato_8h_aeafc9d85e29a73b9b5423cd661bd54c2}{mato\+\_\+free\+\_\+list\+\_\+of\+\_\+modules}} (G\+Array $\ast$a)
\begin{DoxyCompactList}\small\item\em Free the list of modules returned by either of the two functions \mbox{\hyperlink{mato_8h_ac8c86d7dbb7acd09f1884c2e80ec698c}{mato\+\_\+get\+\_\+list\+\_\+of\+\_\+modules()}} or \mbox{\hyperlink{mato_8h_ac8c86d7dbb7acd09f1884c2e80ec698c}{mato\+\_\+get\+\_\+list\+\_\+of\+\_\+modules()}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato_8h_ab49165685fd95d2e9f70f484e367c6f2}{mato\+\_\+data\+\_\+buffer\+\_\+usage}} (int module\+\_\+id, int channel, int $\ast$number\+\_\+of\+\_\+allocated\+\_\+buffers, int $\ast$total\+\_\+sum\+\_\+of\+\_\+ref\+\_\+count)
\begin{DoxyCompactList}\small\item\em Provide a diagnostic information on use of the buffers by a particular channel of a particular module. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato_8h_a6b31044a7afec17426ec4d4e3354aa9f}{mato\+\_\+inc\+\_\+thread\+\_\+count}} ()
\begin{DoxyCompactList}\small\item\em Each module instance (or other part of the program) that creates a new thread should call this funciton for each newly created thread. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mato_8h_a480acc181ff3a7d7c925d64e3d4a7442}{mato\+\_\+dec\+\_\+thread\+\_\+count}} ()
\begin{DoxyCompactList}\small\item\em Each thread that terminates should call this function just before it quits. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_a314629d6f743c699b26a534175986865}\label{mato_8h_a314629d6f743c699b26a534175986865}} 
int \mbox{\hyperlink{mato_8h_a314629d6f743c699b26a534175986865}{mato\+\_\+threads\+\_\+running}} ()
\begin{DoxyCompactList}\small\item\em The number of threads currently running in the system. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mato_8h_ae1a30212d4d2d4f1121684dbd1bb854a}\label{mato_8h_ae1a30212d4d2d4f1121684dbd1bb854a}} 
void \mbox{\hyperlink{mato_8h_ae1a30212d4d2d4f1121684dbd1bb854a}{mato\+\_\+shutdown}} ()
\begin{DoxyCompactList}\small\item\em Releases all resources used by the framework, recommended to be called before the main program terminates. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
volatile int \mbox{\hyperlink{mato_8h_a0f80851fe27966d69a2a0dfbafdb7160}{program\+\_\+runs}}
\begin{DoxyCompactList}\small\item\em This variable is set to non-\/zero when the program is about to terminate. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Mato control framework -\/ main header file. Declarations of the public interface of the framework. The framework manages the data flow between modules of the control architecture. Modules have types and names. There can be multiple instances of the same type of module, having different names. Module instances should only keep their local data inside of one structure that is created for each instance (we call it \char`\"{}instance data\char`\"{}). Each module type contains its \char`\"{}init()\char`\"{} function that registers the module in the framework so that it can be used by the main program and other modules. Each module type is specified by the structure \mbox{\hyperlink{structmodule__specification}{module\+\_\+specification}} that lists the public interface of the module (used by the framework)\+:
\begin{DoxyItemize}
\item create\+\_\+instance\+\_\+callback -\/ creates a new instance of the module, i.\+e. allocates and initializes the module instance data, it is called by the framework when the main program or another module requests to create a new module instance
\item start\+\_\+instance\+\_\+callback -\/ all modules are started by the framework by calling this function at once, typically after all instances have been created
\item delete\+\_\+instance\+\_\+callback -\/ it is called by the framework when the main program or another module reqyests to delete the module instance
\item global\+\_\+message\+\_\+callback -\/ global messages can be sent by anybody and they are immediatelly forwarded to the callback functions of all the modules Modules communicate by posting data in their output channels. Other modules can request the most recent data that have been posted by any module, or subscribe to receive all posted data immediatelly in their subscription callback function. The framework gives the possiblity to list all module types and all modules that are present in the system. Modules can be added and removed dynamically while the system runs. When sending a message, modules should ask the framework for the memory buffer that will be filled by the data of the message the module is sending. The framework deallocates the data buffers when they are not needed anymore automatically, unless the copy\+\_\+mode is specified. 
\end{DoxyItemize}

\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{mato_8h_ad20873465b8c85f182244c5a553f2837}\label{mato_8h_ad20873465b8c85f182244c5a553f2837}} 
\index{mato.h@{mato.h}!create\_instance\_callback@{create\_instance\_callback}}
\index{create\_instance\_callback@{create\_instance\_callback}!mato.h@{mato.h}}
\doxysubsubsection{\texorpdfstring{create\_instance\_callback}{create\_instance\_callback}}
{\footnotesize\ttfamily typedef void$\ast$($\ast$ create\+\_\+instance\+\_\+callback) (int module\+\_\+id)}



Create instance data of a module and initialize it. 

Each module should define this callback. This instance will be from now on always referred by the module\+\_\+id passed in the argument. It is recommended that the module saves it to its instance\+\_\+data. The function should return a pointer to the newly allocated instance data. \mbox{\Hypertarget{mato_8h_a5cdf8c706be95dbe5dc32dda2d0aacdf}\label{mato_8h_a5cdf8c706be95dbe5dc32dda2d0aacdf}} 
\index{mato.h@{mato.h}!start\_instance\_callback@{start\_instance\_callback}}
\index{start\_instance\_callback@{start\_instance\_callback}!mato.h@{mato.h}}
\doxysubsubsection{\texorpdfstring{start\_instance\_callback}{start\_instance\_callback}}
{\footnotesize\ttfamily typedef void($\ast$ start\+\_\+instance\+\_\+callback) (void $\ast$\mbox{\hyperlink{mato__core_8h_a0e0d7e8d878428833528a1123d6558c5}{instance\+\_\+data}})}



Start the module instance. 

Typically, a module instance will create a new thread that will take care of the functionality of the module (active module). Alternately, the module can remain passive -\/ without a thread and only responding to the subscribes... This is also the right place for the module to subscribe to the data channels of other module instances, because they are expected to be instantiated at this point of time \mbox{\Hypertarget{mato_8h_a9345221b935d9505595c583b54d31e86}\label{mato_8h_a9345221b935d9505595c583b54d31e86}} 
\index{mato.h@{mato.h}!subscriber\_callback@{subscriber\_callback}}
\index{subscriber\_callback@{subscriber\_callback}!mato.h@{mato.h}}
\doxysubsubsection{\texorpdfstring{subscriber\_callback}{subscriber\_callback}}
{\footnotesize\ttfamily typedef void($\ast$ subscriber\+\_\+callback) (void $\ast$\mbox{\hyperlink{mato__core_8h_a0e0d7e8d878428833528a1123d6558c5}{instance\+\_\+data}}, int sender\+\_\+module\+\_\+id, int data\+\_\+length, void $\ast$new\+\_\+data\+\_\+ptr)}



Modules that subscribe to the data on channels of other module instances provide this callback. 

It receives the instance data of the subscriber, the id of the sender module, and the actual raw data of the message and its length 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{mato_8h_af3c84af45ac99910057189ede367d72d}\label{mato_8h_af3c84af45ac99910057189ede367d72d}} 
\index{mato.h@{mato.h}!mato\_borrow\_data@{mato\_borrow\_data}}
\index{mato\_borrow\_data@{mato\_borrow\_data}!mato.h@{mato.h}}
\doxysubsubsection{\texorpdfstring{mato\_borrow\_data()}{mato\_borrow\_data()}}
{\footnotesize\ttfamily void mato\+\_\+borrow\+\_\+data (\begin{DoxyParamCaption}\item[{int}]{id\+\_\+module,  }\item[{int}]{channel,  }\item[{int $\ast$}]{data\+\_\+length,  }\item[{void $\ast$$\ast$}]{data }\end{DoxyParamCaption})}



Retrieve the most recently posted data of some channel of some module instance. 

In this case, the data is not copied, but a pointer to read-\/only memory containing the data is provided. The module should return the borrowed pointer back to the framework by calling \mbox{\hyperlink{mato_8h_aedcb803fd4a991e805e6c3813c829a35}{mato\+\_\+release\+\_\+data()}} when the data is not needed anymore. \mbox{\Hypertarget{mato_8h_a411a20bcfa908edbebe617fe5cc54667}\label{mato_8h_a411a20bcfa908edbebe617fe5cc54667}} 
\index{mato.h@{mato.h}!mato\_create\_new\_module\_instance@{mato\_create\_new\_module\_instance}}
\index{mato\_create\_new\_module\_instance@{mato\_create\_new\_module\_instance}!mato.h@{mato.h}}
\doxysubsubsection{\texorpdfstring{mato\_create\_new\_module\_instance()}{mato\_create\_new\_module\_instance()}}
{\footnotesize\ttfamily int mato\+\_\+create\+\_\+new\+\_\+module\+\_\+instance (\begin{DoxyParamCaption}\item[{const char $\ast$}]{module\+\_\+type,  }\item[{const char $\ast$}]{module\+\_\+name }\end{DoxyParamCaption})}



The main program (or other module) can call this function to request creation of a module instance. 

The function returns the new module id. \mbox{\Hypertarget{mato_8h_ab49165685fd95d2e9f70f484e367c6f2}\label{mato_8h_ab49165685fd95d2e9f70f484e367c6f2}} 
\index{mato.h@{mato.h}!mato\_data\_buffer\_usage@{mato\_data\_buffer\_usage}}
\index{mato\_data\_buffer\_usage@{mato\_data\_buffer\_usage}!mato.h@{mato.h}}
\doxysubsubsection{\texorpdfstring{mato\_data\_buffer\_usage()}{mato\_data\_buffer\_usage()}}
{\footnotesize\ttfamily void mato\+\_\+data\+\_\+buffer\+\_\+usage (\begin{DoxyParamCaption}\item[{int}]{module\+\_\+id,  }\item[{int}]{channel,  }\item[{int $\ast$}]{number\+\_\+of\+\_\+allocated\+\_\+buffers,  }\item[{int $\ast$}]{total\+\_\+sum\+\_\+of\+\_\+ref\+\_\+count }\end{DoxyParamCaption})}



Provide a diagnostic information on use of the buffers by a particular channel of a particular module. 

If this starts growing, the callbacks take too much time to process data and should be refactored. \mbox{\Hypertarget{mato_8h_a480acc181ff3a7d7c925d64e3d4a7442}\label{mato_8h_a480acc181ff3a7d7c925d64e3d4a7442}} 
\index{mato.h@{mato.h}!mato\_dec\_thread\_count@{mato\_dec\_thread\_count}}
\index{mato\_dec\_thread\_count@{mato\_dec\_thread\_count}!mato.h@{mato.h}}
\doxysubsubsection{\texorpdfstring{mato\_dec\_thread\_count()}{mato\_dec\_thread\_count()}}
{\footnotesize\ttfamily void mato\+\_\+dec\+\_\+thread\+\_\+count (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Each thread that terminates should call this function just before it quits. 

Decrement the number of threads running. It should be called by each thread that terminates. \mbox{\Hypertarget{mato_8h_af356c7284b6f1d6be285de40d9e23b77}\label{mato_8h_af356c7284b6f1d6be285de40d9e23b77}} 
\index{mato.h@{mato.h}!mato\_get\_data@{mato\_get\_data}}
\index{mato\_get\_data@{mato\_get\_data}!mato.h@{mato.h}}
\doxysubsubsection{\texorpdfstring{mato\_get\_data()}{mato\_get\_data()}}
{\footnotesize\ttfamily void mato\+\_\+get\+\_\+data (\begin{DoxyParamCaption}\item[{int}]{id\+\_\+module,  }\item[{int}]{channel,  }\item[{int $\ast$}]{data\+\_\+length,  }\item[{void $\ast$$\ast$}]{data }\end{DoxyParamCaption})}



Retrieve the most recently posted data of some channel of some module instance. 

Data is copied into new buffer allocated and its pointer is returned in data variable, and the length of the data is set to data\+\_\+length. The calling module should release the memory by calling free() when it is not needed anymore. \mbox{\Hypertarget{mato_8h_a5c6a3a9b7e7969e9d9324b1d937ff2a5}\label{mato_8h_a5c6a3a9b7e7969e9d9324b1d937ff2a5}} 
\index{mato.h@{mato.h}!mato\_get\_list\_of\_all\_modules@{mato\_get\_list\_of\_all\_modules}}
\index{mato\_get\_list\_of\_all\_modules@{mato\_get\_list\_of\_all\_modules}!mato.h@{mato.h}}
\doxysubsubsection{\texorpdfstring{mato\_get\_list\_of\_all\_modules()}{mato\_get\_list\_of\_all\_modules()}}
{\footnotesize\ttfamily G\+Array$\ast$ mato\+\_\+get\+\_\+list\+\_\+of\+\_\+all\+\_\+modules (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Retrieve the list of currently running modules. 

The list should be freed by calling \mbox{\hyperlink{mato_8h_aeafc9d85e29a73b9b5423cd661bd54c2}{mato\+\_\+free\+\_\+list\+\_\+of\+\_\+modules()}} when it is not needed anymore. \mbox{\Hypertarget{mato_8h_ac8c86d7dbb7acd09f1884c2e80ec698c}\label{mato_8h_ac8c86d7dbb7acd09f1884c2e80ec698c}} 
\index{mato.h@{mato.h}!mato\_get\_list\_of\_modules@{mato\_get\_list\_of\_modules}}
\index{mato\_get\_list\_of\_modules@{mato\_get\_list\_of\_modules}!mato.h@{mato.h}}
\doxysubsubsection{\texorpdfstring{mato\_get\_list\_of\_modules()}{mato\_get\_list\_of\_modules()}}
{\footnotesize\ttfamily G\+Array$\ast$ mato\+\_\+get\+\_\+list\+\_\+of\+\_\+modules (\begin{DoxyParamCaption}\item[{char $\ast$}]{type }\end{DoxyParamCaption})}



Retrieve the list of currently running modules of the specified type. 

The list should be freed by calling \mbox{\hyperlink{mato_8h_aeafc9d85e29a73b9b5423cd661bd54c2}{mato\+\_\+free\+\_\+list\+\_\+of\+\_\+modules()}} when it is not needed anymore. \mbox{\Hypertarget{mato_8h_a6b31044a7afec17426ec4d4e3354aa9f}\label{mato_8h_a6b31044a7afec17426ec4d4e3354aa9f}} 
\index{mato.h@{mato.h}!mato\_inc\_thread\_count@{mato\_inc\_thread\_count}}
\index{mato\_inc\_thread\_count@{mato\_inc\_thread\_count}!mato.h@{mato.h}}
\doxysubsubsection{\texorpdfstring{mato\_inc\_thread\_count()}{mato\_inc\_thread\_count()}}
{\footnotesize\ttfamily void mato\+\_\+inc\+\_\+thread\+\_\+count (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Each module instance (or other part of the program) that creates a new thread should call this funciton for each newly created thread. 

Increments the number of threads running. This should be called from each thread that has been started. \mbox{\Hypertarget{mato_8h_a43f0570e3ab59d7a021e93113437dcaf}\label{mato_8h_a43f0570e3ab59d7a021e93113437dcaf}} 
\index{mato.h@{mato.h}!mato\_register\_new\_type\_of\_module@{mato\_register\_new\_type\_of\_module}}
\index{mato\_register\_new\_type\_of\_module@{mato\_register\_new\_type\_of\_module}!mato.h@{mato.h}}
\doxysubsubsection{\texorpdfstring{mato\_register\_new\_type\_of\_module()}{mato\_register\_new\_type\_of\_module()}}
{\footnotesize\ttfamily void mato\+\_\+register\+\_\+new\+\_\+type\+\_\+of\+\_\+module (\begin{DoxyParamCaption}\item[{char $\ast$}]{type,  }\item[{\mbox{\hyperlink{structmodule__specification}{module\+\_\+specification}} $\ast$}]{specification }\end{DoxyParamCaption})}



Register a new module type. 

This is typically called from the init() function of each module type, which should be called directly from the main program. \mbox{\Hypertarget{mato_8h_aedcb803fd4a991e805e6c3813c829a35}\label{mato_8h_aedcb803fd4a991e805e6c3813c829a35}} 
\index{mato.h@{mato.h}!mato\_release\_data@{mato\_release\_data}}
\index{mato\_release\_data@{mato\_release\_data}!mato.h@{mato.h}}
\doxysubsubsection{\texorpdfstring{mato\_release\_data()}{mato\_release\_data()}}
{\footnotesize\ttfamily void mato\+\_\+release\+\_\+data (\begin{DoxyParamCaption}\item[{int}]{id\+\_\+module,  }\item[{int}]{channel,  }\item[{void $\ast$}]{data }\end{DoxyParamCaption})}



Return a borrowed pointer that was obtained either by \mbox{\hyperlink{mato_8h_af3c84af45ac99910057189ede367d72d}{mato\+\_\+borrow\+\_\+data()}} or by a callback in the borrowed\+\_\+pointer mode. 

The id\+\_\+module and channel specify the origin of the message. \mbox{\Hypertarget{mato_8h_a62a0865fa5114c0a254435a1369531cf}\label{mato_8h_a62a0865fa5114c0a254435a1369531cf}} 
\index{mato.h@{mato.h}!mato\_start\_module@{mato\_start\_module}}
\index{mato\_start\_module@{mato\_start\_module}!mato.h@{mato.h}}
\doxysubsubsection{\texorpdfstring{mato\_start\_module()}{mato\_start\_module()}}
{\footnotesize\ttfamily void mato\+\_\+start\+\_\+module (\begin{DoxyParamCaption}\item[{int}]{module\+\_\+id }\end{DoxyParamCaption})}



Start a newly created instance of a particular module. 

This is typically used when the module instance is created later than when the framework has already been started. 

\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{mato_8h_a0f80851fe27966d69a2a0dfbafdb7160}\label{mato_8h_a0f80851fe27966d69a2a0dfbafdb7160}} 
\index{mato.h@{mato.h}!program\_runs@{program\_runs}}
\index{program\_runs@{program\_runs}!mato.h@{mato.h}}
\doxysubsubsection{\texorpdfstring{program\_runs}{program\_runs}}
{\footnotesize\ttfamily volatile int program\+\_\+runs}



This variable is set to non-\/zero when the program is about to terminate. 

All threads should terminate at the earliest possbility 